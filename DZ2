<HTML>
<BODY>
<canvas width="500" , height="500" , id="lab01">
</canvas>

<canvas width="500" , height="500" , id="lab02">
</canvas>
<a href="#" , class="button" , id="btn">Save</a>
<script>
    var canvas = document.getElementById("lab01");
    var ctx = canvas.getContext("2d");

    var canvas2 = document.getElementById("lab02");
    var ctx2 = canvas2.getContext("2d");

    let img = new Image;
    img.src = 'C:\\Users\\Admin\\Documents\\Учёба\\myTown.jpg';
    img.onload = function () {
        ctx.drawImage(img, 0, 0, canvas.width, canvas.height);
    }

    let img_data = ctx.getImageData(0, 0, canvas.width, canvas.height);
    console.log(img_data);

    let midline = canvas2.height / 2;
    for (let i = 0; i < canvas2.height; ++i) {
        img_data.data[4 * (midline * canvas2.width + i)] = 0;
        img_data.data[4 * (midline * canvas2.width + i) + 1] = 0;
        img_data.data[4 * (midline * canvas2.width + i) + 2] = 0;
        img_data.data[4 * (midline * canvas2.width + i) + 3] = 255;

    }

    // for (let i = 0; i < canvas.height; ++i)
    // {
    //     for(let j = 0; j < canvas.width; ++j){
    //         img_data.data[4*(canvas2.width+j)] = img_data.data[4*(canvas2.width+j)]
    //     }
    // }

    ctx2.putImageData(img_data, 0, 0, 0, 0, canvas.width, canvas.height);

    let btn = document.getElementById("btn");
    btn.addEventListener("click", function (e) {
        let dataURL = canvas2.toDataURL("image/png");
        btn.href = dataURL;
        btn.download = "test.png";
    })
</script>

</BODY>
</HTML>
